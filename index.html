<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>性能カスタム記録フォーム</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    .row { display: flex; align-items: center; margin-bottom: 8px; }
    label { width: 120px; }
    select, input[type="text"] { width: 200px; }
    .tier-row { display: flex; align-items: center; gap: 6px; margin-bottom: 8px; }
    .checkbox-row { display: flex; align-items: center; gap: 12px; margin-bottom: 12px; }
    #form-container { display: none; }
    #result { margin-top: 12px; color: green; }
  </style>
  <script>
    let userName = '';

    function onGoogleSignIn(googleUser) {
      google.script.run.withSuccessHandler(name => {
        userName = name;
        document.getElementById('writer').innerHTML =
          `<option value="${name}">${name}</option>`;
        document.getElementById('form-container').style.display = 'block';
      }).getUserInfo;
    }

    function submitForm() {
      const form = {
        writer: document.getElementById('writer').value,
        carNumber: document.getElementById('carNumber').value,
        owner: document.getElementById('owner').value,
        engine: document.querySelector('input[name="engine"]:checked')?.value || '',
        brake: document.querySelector('input[name="brake"]:checked')?.value || '',
        transmission: document.querySelector('input[name="transmission"]:checked')?.value || '',
        suspension: document.querySelector('input[name="suspension"]:checked')?.value || '',
        armor: document.getElementById('armor').checked ? 'ON' : 'OFF',
        turbo: document.getElementById('turbo').checked ? 'ON' : 'OFF',
        harness: document.getElementById('harness').checked ? 'ON' : 'OFF',
        nos: document.getElementById('nos').checked ? 'ON' : 'OFF'
      };

      google.script.run.withSuccessHandler(msg => {
        document.getElementById('result').textContent = msg;
        document.getElementById('main-form').reset();
      }).submitData(form);
    }
  </script>
  <script src="https://accounts.google.com/gsi/client" async defer></script>
</head>
<body>
  <div id="g_id_onload"
       data-client_id="735792055029-5qb8bcm39qg7g8qrsh60di4pq87afos3.apps.googleusercontent.com"
       data-context="signin"
       data-ux_mode="popup"
       data-callback="onGoogleSignIn"
       data-auto_prompt="false"></div>
  <div class="g_id_signin" data-type="standard"></div>

  <div id="form-container">
    <form id="main-form" onsubmit="event.preventDefault(); submitForm();">
      <div class="row">
        <label for="writer">記録者名</label>
        <select id="writer" required></select>
      </div>
      <div class="row">
        <label for="carNumber">車両番号</label>
        <input type="text" id="carNumber" required>
      </div>
      <div class="row">
        <label for="owner">オーナー名</label>
        <input type="text" id="owner" required>
      </div>

      <div class="tier-row"><label>エンジン</label>
        <label><input type="radio" name="engine" value="ティア1">ティア1</label>
        <label><input type="radio" name="engine" value="ティア2">ティア2</label>
        <label><input type="radio" name="engine" value="ティア3">ティア3</label>
        <label><input type="radio" name="engine" value="ティア4">ティア4</label>
        <label><input type="radio" name="engine" value="ティア5">ティア5</label>
      </div>

      <div class="tier-row"><label>ブレーキ</label>
        <label><input type="radio" name="brake" value="ティア1">ティア1</label>
        <label><input type="radio" name="brake" value="ティア2">ティア2</label>
        <label><input type="radio" name="brake" value="ティア3">ティア3</label>
      </div>

      <div class="tier-row"><label>トランスミッション</label>
        <label><input type="radio" name="transmission" value="ティア1">ティア1</label>
        <label><input type="radio" name="transmission" value="ティア2">ティア2</label>
        <label><input type="radio" name="transmission" value="ティア3">ティア3</label>
        <label><input type="radio" name="transmission" value="ティア4">ティア4</label>
      </div>

      <div class="tier-row"><label>サスペンション</label>
        <label><input type="radio" name="suspension" value="ティア1">ティア1</label>
        <label><input type="radio" name="suspension" value="ティア2">ティア2</label>
        <label><input type="radio" name="suspension" value="ティア3">ティア3</label>
        <label><input type="radio" name="suspension" value="ティア4">ティア4</label>
        <label><input type="radio" name="suspension" value="ティア5">ティア5</label>
      </div>

      <div class="checkbox-row">
        <label><input type="checkbox" id="armor">アーマー</label>
        <label><input type="checkbox" id="turbo">ターボ</label>
        <label><input type="checkbox" id="harness">ハーネス</label>
        <label><input type="checkbox" id="nos">NOS</label>
      </div>

      <button type="submit">記録する</button>
    </form>
    <div id="result"></div>
  </div>
</body>
</html>
